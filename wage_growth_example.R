library(ggplot2)

num.c <- 90000
by.month <- data.frame(
                 structure(list(start_month = 0:35, mean_normed = c(1, 1.11199078009128, 
1.18499637916233, 1.24800850769807, 1.3041015725846, 1.34619227067265, 
1.40153549263733, 1.43637491514491, 1.46984875360732, 1.49941975133651, 
1.53493238746695, 1.56672251312447, 1.60285797129425, 1.63641843538979, 
1.66967370986844, 1.68063453466043, 1.69306714604508, 1.72087542016847, 
1.74514104188664, 1.75282051682762, 1.76623341218126, 1.78009441060453, 
1.79911625778719, 1.83750807436224, 1.85995912996781, 1.87289241807216, 
1.88744358179938, 1.90181422431455, 1.90312053919906, 1.92124036626149, 
1.89262227259733, 1.88707216851112, 1.85020679590532, 1.87487838984825, 
1.8821525763266, 1.89738327539684), num = c(76450L, 47987L, 40100L, 
35151L, 31754L, 28830L, 26088L, 24077L, 22097L, 20307L, 18797L, 
17399L, 16035L, 14685L, 13350L, 12145L, 11117L, 10266L, 9234L, 
8427L, 7593L, 6826L, 6149L, 5485L, 4888L, 4368L, 3795L, 3306L, 
2933L, 2481L, 2043L, 1658L, 1314L, 967L, 666L, 323L), se = c(0, 
0.00244185849989539, 0.00317532417954777, 0.00398015975779084, 
0.00453751786415581, 0.00496621911092679, 0.00629878527305102, 
0.00683471601405438, 0.00707395323084725, 0.0075334964051894, 
0.00814657203636137, 0.0095202176174252, 0.00937211276306845, 
0.0116422952043661, 0.0129302152643192, 0.013690534533108, 0.0122386970500907, 
0.013988642540635, 0.01457472008387, 0.0154723237316461, 0.0158603041788552, 
0.0164611744266318, 0.0169694021950805, 0.019288172027127, 0.0230350439712147, 
0.0228210727129082, 0.0258322057487612, 0.0314474100854444, 0.0287006272402416, 
0.0321231291105021, 0.0314725415328345, 0.0316767723815074, 0.0337540354382221, 
0.0407979631924576, 0.0492795178530229, 0.0790265131956014)), .Names = c("start_month", 
"mean_normed", "num", "se"), row.names = c(NA, 36L), class = "data.frame"))

write.csv(by.month, "by_month_data.csv")

g <- qplot(start_month, mean_normed, data = by.month) +
  geom_errorbar(aes(ymin = mean_normed - 2*se, ymax = mean_normed + 2*se)) +
  geom_line() + xlab("Months since first job on oDesk") +
  ylab("Average hourly wage earned in that period, as multiple of first period wage") +
  geom_text(aes(x = 5, y = 1.8, label=paste("# contractors =", num.c)))


svg("wage_growth_plot.svg")
print(g)
dev.off() 
